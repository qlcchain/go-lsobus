syntax = "proto3";
package proto;
option go_package = ".;proto";

import "google/api/annotations.proto";

message VersionRequest{}

message VersionResponse {
  string buildTime = 1;
  string version = 2;
  string hash = 3;
}

service ChainAPI{
  rpc Version(VersionRequest) returns (VersionResponse){
    option (google.api.http) = {
      post: "/chain/version"
      body: "*"
    };
  }
}

message User {
  string address = 1;
  string name = 2;
}

message ConnectionStaticParam {
  string productId = 1;
  string srcCompanyName = 2 ;
  string srcRegion = 3;
  string srcCity = 4;
  string srcDataCenter = 5;
  string srcPort = 6;
  string dstCompanyName = 7;
  string dstRegion = 8;
  string dstCity = 9;
  string dstDataCenter = 10;
  string dstPort = 11;
}

message ConnectionDynamicParam {
  string connectionName = 1;
  string paymentType = 2;
  string billingType = 3;
  string currency = 4;
  string serviceClass = 5;
  string bandwidth = 6;
  string billingUnit = 7;
  string price = 8;
  int64 startTime = 9;
  int64 endTime = 10;
}

message ConnectionParam {
    ConnectionStaticParam staticParam = 1;
    ConnectionDynamicParam dynamicParam = 2;
}

message CreateOrderParam {
  ContractPrivacyParam privacy = 1;
  User buyer = 2;
  User seller = 3;
  repeated ConnectionParam cps = 4;
}

message OrderRsp {
  string orderIdOnChain = 1;
}

message GetOrderInfoByInternalId {
  string internalId = 1;
}

message OrderLifeTrack {
  string contractState = 1;
  string orderState =2;
  string reason = 3;
  int64  time = 4;
  string Hash = 5;
}

message OrderInfoRsp {
  User buyer = 1;
  User seller = 2;
  string orderId = 3;
  string orderType = 4;
  string orderState = 5;
  string contractState = 6;
  repeated ConnectionParam connections = 7;
  repeated OrderLifeTrack track = 8;
}

message ContractPrivacyParam {
  string privateFrom = 1;
  repeated string privateFor =2;
  string privateGroupID = 3;
}

message ChangeConnectionParam {
  string productId = 1;
  ConnectionDynamicParam dynamicParam = 2;
}

message ChangeOrderParam {
  ContractPrivacyParam privacy = 1;
  User buyer = 2;
  User seller = 3;
  repeated ChangeConnectionParam changeConnectionParam = 4;
}

message TerminateOrderParam {
  ContractPrivacyParam privacy = 1;
  User buyer = 2;
  User seller = 3;
  repeated string productId = 4;
}

service OrderAPI{
  rpc CreateOrder(CreateOrderParam) returns (OrderRsp){
    option (google.api.http) = {
      post: "/order/create"
      body: "*"
    };
  }
  rpc OrderInfo(GetOrderInfoByInternalId) returns (OrderInfoRsp){
    option (google.api.http) = {
      post: "/order/info"
      body: "*"
    };
  }
  rpc ChangeOrder(ChangeOrderParam) returns (OrderRsp){
    option (google.api.http) = {
      post: "/order/info"
      body: "*"
    };
  }
  rpc TerminateOrder(TerminateOrderParam) returns (OrderRsp){
    option (google.api.http) = {
      post: "/order/info"
      body: "*"
    };
  }
}

